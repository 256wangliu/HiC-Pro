## Nicolas Servant
## Hi-C pipeline
## v 1.0
## 16-12-13


## *** What is it ? ***

This pipeline was designed to process a Hi-C sample, from the raw fastq failes (paired-end Illumina data) to the normalized interaction maps.
It is linked to the HiTC BioConductor package.

## *** Dependancies ? ***

The Hi-C pipeline requires :
- The bowtie2 mapper
- Perl
- R with the HiTC BioConductor package

## *** How to use it ? ***

1- Edit the configuration file
2- Run the Makefile

make --file Makefile CONFIG_FILE=config.txt all


## *** Folders description ***

- rawdata
All rawdata should be available on this folder. Multiple files for one sample are allowed
- scripts
This is the core of the pipeline. All the scripts are in this folder
- Annotation
Annotation files such as mappability tracks, chromosome size, restriction sites, etc.
- bowtie_results
To store the mapping results
- doc
To store the file results such as the mapping statistics, etc.
- hic_results
To store the Hi-C processed data
- logs

#
# Eric Viara optimizations
# 2014-06-19
# Change NS - 05/01/2015
#

I.

If you want to use HiC pipeline without torque, simply type:
make CONFIG_FILE=config.txt all
as previously

BUT: note that some operations will not be performed by all target and have to be done separately:
make CONFIG_FILE=config.txt plot_MappingProportion plot_FragmentInfo
make CONFIG_FILE=config.txt norm
make CONFIG_FILE=config.txt mapping_clean

II.
A.
If you want to use torque (the prefered way), type:
make CONFIG_FILE=config.txt make_torque_script

you will get the following message:
The following command will launch 3 torque jobs:
qsub HiC_torque_ev_test.sh

B.
execute the displayed command:
qsub HiC_torque_ev_test.sh
774410[].torque.curie.fr

C.
then wait for the torque mails... :)

Once executed succesfully (may take several hours), then type:
make CONFIG_FILE=config.txt build_contact_maps
